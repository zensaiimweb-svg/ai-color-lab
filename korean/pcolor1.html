<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE COVE - ì¸¡ìƒ‰ê¸° ê°’ ì…ë ¥</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Additional styles for colorimeter page */
        .diagnosis-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: var(--color-sand);
            border-radius: 2px;
            margin-bottom: 3rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--color-accent), var(--color-accent-light));
            width: 33%;
            transition: width 0.5s ease;
        }

        .step-number {
            font-family: var(--font-body);
            font-size: 0.875rem;
            font-weight: 300;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            color: var(--color-accent);
            margin-bottom: 1rem;
            text-align: center;
        }

        .question-title {
            text-align: center;
            margin-bottom: 1.5rem;
            animation: fadeInUp 0.6s ease-out;
        }

        .instruction-text {
            text-align: center;
            color: var(--color-slate);
            font-size: 1rem;
            margin-bottom: 3rem;
            line-height: 1.8;
        }

        .colorimeter-guide {
            background: white;
            padding: 2.5rem;
            border-radius: 12px;
            margin-bottom: 3rem;
            border: 3px solid var(--color-sand);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .guide-title {
            font-family: var(--font-display);
            font-size: 1.3rem;
            color: var(--color-black);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .guide-icon {
            font-size: 1.5rem;
        }

        .guide-steps {
            list-style: none;
            padding: 0;
        }

        .guide-steps li {
            padding: 1rem 0;
            padding-left: 2.5rem;
            position: relative;
            color: var(--color-slate);
            border-bottom: 1px solid var(--color-sand);
        }

        .guide-steps li:last-child {
            border-bottom: none;
        }

        .guide-steps li::before {
            content: attr(data-step);
            position: absolute;
            left: 0;
            width: 28px;
            height: 28px;
            background: var(--color-accent);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: bold;
        }

        .input-section {
            background: white;
            padding: 3rem;
            border-radius: 12px;
            border: 3px solid var(--color-sand);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 3rem;
        }

        .input-group {
            margin-bottom: 2rem;
        }

        .input-label {
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--color-charcoal);
            margin-bottom: 1rem;
            display: block;
        }

        .input-sublabel {
            font-size: 0.9rem;
            color: var(--color-slate);
            margin-bottom: 1rem;
            display: block;
        }

        .color-input-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .color-input-wrapper {
            position: relative;
        }

        .color-label {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--color-charcoal);
            margin-bottom: 0.5rem;
            display: block;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .color-input {
            width: 100%;
            padding: 1.2rem;
            border: 3px solid var(--color-sand);
            border-radius: 8px;
            font-family: var(--font-body);
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--color-charcoal);
            text-align: center;
            transition: all 0.3s ease;
            background: white;
        }

        .color-input:focus {
            outline: none;
            border-color: var(--color-accent);
            box-shadow: 0 5px 20px rgba(157, 139, 124, 0.15);
            transform: translateY(-2px);
        }

        .color-input.red { border-color: #ffcccb; }
        .color-input.red:focus { border-color: #ff6b6b; }

        .color-input.green { border-color: #d4edda; }
        .color-input.green:focus { border-color: #4caf50; }

        .color-input.blue { border-color: #cce5ff; }
        .color-input.blue:focus { border-color: #2196f3; }

        .color-input.lightness { border-color: #e0e0e0; }
        .color-input.lightness:focus { border-color: #757575; }

        .color-input.a-axis { border-color: #ffcdd2; }
        .color-input.a-axis:focus { border-color: #e57373; }

        .color-input.b-axis { border-color: #fff9c4; }
        .color-input.b-axis:focus { border-color: #ffd54f; }

        .input-hint {
            font-size: 0.75rem;
            color: var(--color-slate);
            margin-top: 0.3rem;
            text-align: center;
        }

        .color-preview {
            width: 100%;
            height: 120px;
            border-radius: 12px;
            border: 3px solid var(--color-sand);
            margin-top: 2rem;
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-slate);
            font-size: 0.9rem;
        }

        .measurement-area {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .measurement-section {
            background: var(--color-cream);
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            border: 3px solid var(--color-sand);
            transition: all 0.3s ease;
        }

        .measurement-section:hover {
            border-color: var(--color-accent);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }

        .measurement-title {
            font-family: var(--font-display);
            font-size: 1.3rem;
            color: var(--color-black);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .measurement-icon {
            font-size: 1.8rem;
        }

        .mini-preview {
            width: 100%;
            height: 60px;
            border-radius: 8px;
            border: 2px solid var(--color-sand);
            margin-top: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            color: var(--color-slate);
            transition: all 0.3s ease;
        }

        .average-result {
            background: linear-gradient(135deg, rgba(157, 139, 124, 0.08) 0%, white 100%);
            padding: 2.5rem;
            border-radius: 12px;
            border: 4px solid var(--color-accent);
            margin-top: 3rem;
            box-shadow: 0 10px 30px rgba(157, 139, 124, 0.15);
        }

        .average-title {
            font-family: var(--font-display);
            font-size: 1.8rem;
            color: var(--color-black);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            justify-content: center;
        }

        .average-icon {
            font-size: 2rem;
        }

        .average-values {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--color-charcoal);
            margin-bottom: 1.5rem;
            font-family: monospace;
            letter-spacing: 0.1em;
        }

        .area-card {
            background: var(--color-cream);
            padding: 1.5rem;
            border-radius: 8px;
            border: 2px solid var(--color-sand);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .area-card:hover {
            border-color: var(--color-accent);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        }

        .area-card.selected {
            border-color: var(--color-accent);
            border-width: 3px;
            background: white;
        }

        .area-card.selected::before {
            content: 'âœ“';
            float: right;
            width: 24px;
            height: 24px;
            background: var(--color-accent);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: bold;
        }

        .area-name {
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--color-black);
            margin-bottom: 0.5rem;
        }

        .area-description {
            font-size: 0.85rem;
            color: var(--color-slate);
            line-height: 1.5;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 3rem;
        }

        .btn {
            padding: 1.2rem 3rem;
            font-family: var(--font-body);
            font-size: 1rem;
            font-weight: 400;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            cursor: pointer;
            border: none;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .btn-secondary {
            background: transparent;
            color: var(--color-charcoal);
            border: 2px solid var(--color-sand);
        }

        .btn-secondary:hover {
            border-color: var(--color-accent);
            background: var(--color-sand);
        }

        .btn-primary {
            background: var(--color-black);
            color: var(--color-cream);
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: var(--color-accent);
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .btn-primary:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary span {
            position: relative;
            z-index: 1;
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .helper-text {
            text-align: center;
            color: var(--color-slate);
            font-size: 0.85rem;
            margin-top: 1rem;
            font-style: italic;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .diagnosis-container {
                padding: 2rem 1.5rem;
            }

            .color-input-grid {
                grid-template-columns: 1fr;
            }

            .measurement-area {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }

            .input-section,
            .colorimeter-guide {
                padding: 2rem 1.5rem;
            }
        }
    </style>
</head>
<body>
    <section class="hero-section" style="min-height: auto; padding: 2rem;">
        <div class="diagnosis-container">
            <!-- Progress Bar -->
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <p class="step-number">Step 1 of 3</p>

            <h2 class="question-title">ì¸¡ìƒ‰ê¸°ë¡œ í”¼ë¶€í†¤ì„ ì¸¡ì •í•´ì£¼ì„¸ìš”</h2>
            <p class="instruction-text">
                ì¸¡ìƒ‰ê¸°ë¥¼ í”¼ë¶€ì— ëŒ€ê³  RGB ê°’ì„ ì¸¡ì •í•œ í›„<br>
                ì•„ë˜ì— ì…ë ¥í•´ì£¼ì„¸ìš”
            </p>

            <!-- Colorimeter Guide -->
            <div class="colorimeter-guide">
                <h3 class="guide-title">
                    <span class="guide-icon">ğŸ“±</span>
                    ì¸¡ìƒ‰ê¸° ì‚¬ìš© ë°©ë²•
                </h3>
                <ul class="guide-steps">
                    <li data-step="1">ì¸¡ìƒ‰ê¸° ì „ì›ì„ ì¼œê³  ì˜ì  ì¡°ì •ì„ í•©ë‹ˆë‹¤</li>
                    <li data-step="2">ì¸¡ì •í•  í”¼ë¶€ ë¶€ìœ„ë¥¼ ê¹¨ë—í•˜ê²Œ ë‹¦ìŠµë‹ˆë‹¤</li>
                    <li data-step="3">ì¸¡ìƒ‰ê¸°ë¥¼ í”¼ë¶€ì— ìˆ˜ì§ìœ¼ë¡œ ê°€ë³ê²Œ ëŒ‘ë‹ˆë‹¤</li>
                    <li data-step="4">ì¸¡ì • ë²„íŠ¼ì„ ëˆ„ë¥´ê³  RGB ê°’ì„ í™•ì¸í•©ë‹ˆë‹¤</li>
                    <li data-step="5">ì•„ë˜ ì…ë ¥ë€ì— ì¸¡ì •ëœ ê°’ì„ ì…ë ¥í•©ë‹ˆë‹¤</li>
                </ul>
            </div>

            <!-- Measurement Areas - All 3 -->
            <div class="input-section">
                <div class="input-group">
                    <label class="input-label">3ê°œ ë¶€ìœ„ë¥¼ ëª¨ë‘ ì¸¡ì •í•´ì£¼ì„¸ìš”</label>
                    <p class="input-sublabel">ê° ë¶€ìœ„ë¥¼ ì¸¡ì •í•˜ì—¬ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ í‰ê· ê°’ì´ ê³„ì‚°ë©ë‹ˆë‹¤ (LAB ìƒ‰ê³µê°„)</p>
                </div>

                <!-- Forehead Measurement -->
                <div class="measurement-section">
                    <h3 class="measurement-title">
                        <span class="measurement-icon">1ï¸âƒ£</span>
                        ì´ë§ˆ ì¤‘ì•™
                    </h3>
                    
                    <div class="color-input-grid">
                        <div class="color-input-wrapper">
                            <label class="color-label">L (ëª…ë„)</label>
                            <input 
                                type="number" 
                                class="color-input lightness" 
                                id="forehead_l"
                                min="0" 
                                max="100" 
                                step="0.1"
                                placeholder="0"
                                oninput="updateAverages()"
                            >
                            <p class="input-hint">0-100</p>
                        </div>
                        
                        <div class="color-input-wrapper">
                            <label class="color-label">A (ì´ˆë¡â†”ë¹¨ê°•)</label>
                            <input 
                                type="number" 
                                class="color-input a-axis" 
                                id="forehead_a"
                                min="-128" 
                                max="127" 
                                step="0.1"
                                placeholder="0"
                                oninput="updateAverages()"
                            >
                            <p class="input-hint">-128 ~ 127</p>
                        </div>
                        
                        <div class="color-input-wrapper">
                            <label class="color-label">B (íŒŒë‘â†”ë…¸ë‘)</label>
                            <input 
                                type="number" 
                                class="color-input b-axis" 
                                id="forehead_b"
                                min="-128" 
                                max="127" 
                                step="0.1"
                                placeholder="0"
                                oninput="updateAverages()"
                            >
                            <p class="input-hint">-128 ~ 127</p>
                        </div>
                    </div>

                    <div class="mini-preview" id="preview_forehead">
                        ì¸¡ì • ëŒ€ê¸° ì¤‘...
                    </div>
                </div>

                <!-- Cheek Measurement -->
                <div class="measurement-section">
                    <h3 class="measurement-title">
                        <span class="measurement-icon">2ï¸âƒ£</span>
                        ë³¼
                    </h3>
                    
                    <div class="color-input-grid">
                        <div class="color-input-wrapper">
                            <label class="color-label">L (ëª…ë„)</label>
                            <input 
                                type="number" 
                                class="color-input lightness" 
                                id="cheek_l"
                                min="0" 
                                max="100" 
                                step="0.1"
                                placeholder="0"
                                oninput="updateAverages()"
                            >
                            <p class="input-hint">0-100</p>
                        </div>
                        
                        <div class="color-input-wrapper">
                            <label class="color-label">A (ì´ˆë¡â†”ë¹¨ê°•)</label>
                            <input 
                                type="number" 
                                class="color-input a-axis" 
                                id="cheek_a"
                                min="-128" 
                                max="127" 
                                step="0.1"
                                placeholder="0"
                                oninput="updateAverages()"
                            >
                            <p class="input-hint">-128 ~ 127</p>
                        </div>
                        
                        <div class="color-input-wrapper">
                            <label class="color-label">B (íŒŒë‘â†”ë…¸ë‘)</label>
                            <input 
                                type="number" 
                                class="color-input b-axis" 
                                id="cheek_b"
                                min="-128" 
                                max="127" 
                                step="0.1"
                                placeholder="0"
                                oninput="updateAverages()"
                            >
                            <p class="input-hint">-128 ~ 127</p>
                        </div>
                    </div>

                    <div class="mini-preview" id="preview_cheek">
                        ì¸¡ì • ëŒ€ê¸° ì¤‘...
                    </div>
                </div>

                <!-- Jawline Measurement -->
                <div class="measurement-section">
                    <h3 class="measurement-title">
                        <span class="measurement-icon">3ï¸âƒ£</span>
                        í„±ì„ 
                    </h3>
                    
                    <div class="color-input-grid">
                        <div class="color-input-wrapper">
                            <label class="color-label">L (ëª…ë„)</label>
                            <input 
                                type="number" 
                                class="color-input lightness" 
                                id="jawline_l"
                                min="0" 
                                max="100" 
                                step="0.1"
                                placeholder="0"
                                oninput="updateAverages()"
                            >
                            <p class="input-hint">0-100</p>
                        </div>
                        
                        <div class="color-input-wrapper">
                            <label class="color-label">A (ì´ˆë¡â†”ë¹¨ê°•)</label>
                            <input 
                                type="number" 
                                class="color-input a-axis" 
                                id="jawline_a"
                                min="-128" 
                                max="127" 
                                step="0.1"
                                placeholder="0"
                                oninput="updateAverages()"
                            >
                            <p class="input-hint">-128 ~ 127</p>
                        </div>
                        
                        <div class="color-input-wrapper">
                            <label class="color-label">B (íŒŒë‘â†”ë…¸ë‘)</label>
                            <input 
                                type="number" 
                                class="color-input b-axis" 
                                id="jawline_b"
                                min="-128" 
                                max="127" 
                                step="0.1"
                                placeholder="0"
                                oninput="updateAverages()"
                            >
                            <p class="input-hint">-128 ~ 127</p>
                        </div>
                    </div>

                    <div class="mini-preview" id="preview_jawline">
                        ì¸¡ì • ëŒ€ê¸° ì¤‘...
                    </div>
                </div>

                <!-- Average Result -->
                <div class="average-result">
                    <h3 class="average-title">
                        <span class="average-icon">ğŸ“Š</span>
                        í‰ê·  í”¼ë¶€í†¤
                    </h3>
                    <div class="average-values" id="averageValues">
                        L: - / A: - / B: -
                    </div>
                    <div class="color-preview" id="colorPreview">
                        3ê°œ ë¶€ìœ„ë¥¼ ëª¨ë‘ ì¸¡ì •í•˜ë©´ í‰ê· ê°’ì´ í‘œì‹œë©ë‹ˆë‹¤
                    </div>
                    
                    <p class="helper-text">
                        ğŸ’¡ Tip: ê° ë¶€ìœ„ë¥¼ 2-3íšŒ ì¸¡ì •í•˜ì—¬ í‰ê· ê°’ì„ ì…ë ¥í•˜ë©´ ë” ì •í™•í•©ë‹ˆë‹¤
                    </p>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="button-group">
                <button class="btn btn-secondary" onclick="goBack()">
                    <span>ì´ì „</span>
                </button>
                <button class="btn btn-primary" id="nextBtn" onclick="goNext()" disabled>
                    <span>ë‹¤ìŒ</span>
                </button>
            </div>
        </div>
    </section>

    <script>
        let measurementData = {
            forehead: { l: null, a: null, b: null },
            cheek: { l: null, a: null, b: null },
            jawline: { l: null, a: null, b: null },
            average: { l: null, a: null, b: null }
        };

        // LAB to RGB conversion for preview
        function labToRgb(l, a, b) {
            // LAB to XYZ
            let y = (l + 16) / 116;
            let x = a / 500 + y;
            let z = y - b / 200;

            x = 0.95047 * ((x * x * x > 0.008856) ? x * x * x : (x - 16/116) / 7.787);
            y = 1.00000 * ((y * y * y > 0.008856) ? y * y * y : (y - 16/116) / 7.787);
            z = 1.08883 * ((z * z * z > 0.008856) ? z * z * z : (z - 16/116) / 7.787);

            // XYZ to RGB
            let r = x *  3.2406 + y * -1.5372 + z * -0.4986;
            let g = x * -0.9689 + y *  1.8758 + z *  0.0415;
            let bl = x *  0.0557 + y * -0.2040 + z *  1.0570;

            r = (r > 0.0031308) ? (1.055 * Math.pow(r, 1/2.4) - 0.055) : 12.92 * r;
            g = (g > 0.0031308) ? (1.055 * Math.pow(g, 1/2.4) - 0.055) : 12.92 * g;
            bl = (bl > 0.0031308) ? (1.055 * Math.pow(bl, 1/2.4) - 0.055) : 12.92 * bl;

            return {
                r: Math.max(0, Math.min(255, Math.round(r * 255))),
                g: Math.max(0, Math.min(255, Math.round(g * 255))),
                b: Math.max(0, Math.min(255, Math.round(bl * 255)))
            };
        }

        function updateAverages() {
            // Get all LAB values
            const forehead_l = parseFloat(document.getElementById('forehead_l').value) || 0;
            const forehead_a = parseFloat(document.getElementById('forehead_a').value) || 0;
            const forehead_b = parseFloat(document.getElementById('forehead_b').value) || 0;

            const cheek_l = parseFloat(document.getElementById('cheek_l').value) || 0;
            const cheek_a = parseFloat(document.getElementById('cheek_a').value) || 0;
            const cheek_b = parseFloat(document.getElementById('cheek_b').value) || 0;

            const jawline_l = parseFloat(document.getElementById('jawline_l').value) || 0;
            const jawline_a = parseFloat(document.getElementById('jawline_a').value) || 0;
            const jawline_b = parseFloat(document.getElementById('jawline_b').value) || 0;

            // Update mini previews
            updateMiniPreview('forehead', forehead_l, forehead_a, forehead_b);
            updateMiniPreview('cheek', cheek_l, cheek_a, cheek_b);
            updateMiniPreview('jawline', jawline_l, jawline_a, jawline_b);

            // Save individual measurements
            measurementData.forehead = { l: forehead_l, a: forehead_a, b: forehead_b };
            measurementData.cheek = { l: cheek_l, a: cheek_a, b: cheek_b };
            measurementData.jawline = { l: jawline_l, a: jawline_a, b: jawline_b };

            // Check if all areas are measured (ì…ë ¥ê°’ì´ ìˆëŠ”ì§€ ì²´í¬)
            const allMeasured = 
                document.getElementById('forehead_l').value !== '' && 
                document.getElementById('cheek_l').value !== '' && 
                document.getElementById('jawline_l').value !== '';

            if (allMeasured) {
                // Calculate averages
                const avg_l = ((forehead_l + cheek_l + jawline_l) / 3).toFixed(2);
                const avg_a = ((forehead_a + cheek_a + jawline_a) / 3).toFixed(2);
                const avg_b = ((forehead_b + cheek_b + jawline_b) / 3).toFixed(2);

                measurementData.average = { 
                    l: parseFloat(avg_l), 
                    a: parseFloat(avg_a), 
                    b: parseFloat(avg_b) 
                };

                // Update display
                document.getElementById('averageValues').textContent = 
                    `L: ${avg_l} / A: ${avg_a} / B: ${avg_b}`;

                // Convert to RGB for preview
                const rgb = labToRgb(parseFloat(avg_l), parseFloat(avg_a), parseFloat(avg_b));
                const preview = document.getElementById('colorPreview');
                preview.style.backgroundColor = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
                preview.textContent = `í‰ê·  í”¼ë¶€í†¤: LAB(${avg_l}, ${avg_a}, ${avg_b})`;
                preview.style.color = parseFloat(avg_l) > 50 ? '#333' : '#fff';
                preview.style.fontWeight = '600';
                preview.style.fontSize = '1.1rem';

                // Enable next button
                document.getElementById('nextBtn').disabled = false;
            } else {
                // Reset average display
                document.getElementById('averageValues').textContent = 'L: - / A: - / B: -';
                const preview = document.getElementById('colorPreview');
                preview.style.backgroundColor = 'transparent';
                preview.textContent = '3ê°œ ë¶€ìœ„ë¥¼ ëª¨ë‘ ì¸¡ì •í•˜ë©´ í‰ê· ê°’ì´ í‘œì‹œë©ë‹ˆë‹¤';
                preview.style.color = 'var(--color-slate)';
                preview.style.fontWeight = 'normal';
                preview.style.fontSize = '0.9rem';

                // Disable next button
                document.getElementById('nextBtn').disabled = true;
            }
        }

        function updateMiniPreview(area, l, a, b) {
            const preview = document.getElementById(`preview_${area}`);
            
            if (l > 0) {
                const rgb = labToRgb(l, a, b);
                preview.style.backgroundColor = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
                preview.textContent = `LAB(${l.toFixed(1)}, ${a.toFixed(1)}, ${b.toFixed(1)})`;
                preview.style.color = l > 50 ? '#333' : '#fff';
                preview.style.fontWeight = '500';
            } else {
                preview.style.backgroundColor = 'transparent';
                preview.textContent = 'ì¸¡ì • ëŒ€ê¸° ì¤‘...';
                preview.style.color = 'var(--color-slate)';
                preview.style.fontWeight = 'normal';
            }
        }

        function goNext() {
            // Save data to localStorage
            let savedData = JSON.parse(localStorage.getItem('personalColorData') || '{}');
            savedData.colorimeter = measurementData;
            localStorage.setItem('personalColorData', JSON.stringify(savedData));
            
            // Move to next step
            window.location.href = 'pcolor2.html';
        }

        function goBack() {
            window.location.href = 'korean.html';
        }

        // Load saved data if exists
        window.onload = function() {
            const savedData = JSON.parse(localStorage.getItem('personalColorData') || '{}');
            if (savedData.colorimeter) {
                const data = savedData.colorimeter;
                
                // Restore forehead values
                if (data.forehead) {
                    document.getElementById('forehead_l').value = data.forehead.l || '';
                    document.getElementById('forehead_a').value = data.forehead.a || '';
                    document.getElementById('forehead_b').value = data.forehead.b || '';
                }
                
                // Restore cheek values
                if (data.cheek) {
                    document.getElementById('cheek_l').value = data.cheek.l || '';
                    document.getElementById('cheek_a').value = data.cheek.a || '';
                    document.getElementById('cheek_b').value = data.cheek.b || '';
                }
                
                // Restore jawline values
                if (data.jawline) {
                    document.getElementById('jawline_l').value = data.jawline.l || '';
                    document.getElementById('jawline_a').value = data.jawline.a || '';
                    document.getElementById('jawline_b').value = data.jawline.b || '';
                }
                
                updateAverages();
            }
        }
    </script>
</body>
</html>
